<?xml version="1.0" encoding="utf-8"?>
  <rss version="2.0"
        xmlns:content="http://purl.org/rss/1.0/modules/content/"
        xmlns:atom="http://www.w3.org/2005/Atom"
  >
  <channel>
    <title>mtcle</title>
    <link href="http://mtcle.github.io/blog//feed/" rel="self" />
    <link href="http://mtcle.github.io/blog/" />
    <lastBuildDate>2014-01-13T16:31:05+08:00</lastBuildDate>
    <webMaster>mtcle@126.com</webMaster>
    
    <item>
      <title>Mysql笔记</title>
      <link href="http://mtcle.github.io/blog//2014/01/mysql/"/>
      <pubDate>2014-01-13T00:00:00+08:00</pubDate>
      <author>mtcle</author>
      <guid>http://mtcle.github.io/blog//2014/01/mysql</guid>
      <content:encoded><![CDATA[<hr />

<h3>以前学习过sqlsever，对于一些基本查询及联合查询基本了解，这里记录下</h3>

<h3>最近使用jdbc连接mysql的一些注意事项也能让我以后再次使用mysql时可以回过头来查阅。</h3>

<hr />

<h4>1.加载驱动：  <code>Class.forName("com.mysql.jdbc.Driver");</code></h4>

<h4>2.建立连接：  `Connection connection =DriverManager.getConnection</h4>

<h4>("jdbc:mysql://localhost/book_mgr?characterEncoding=utf8","root", "password");//这个要在数据库后面</h4>

<h4>写上查询字符集，否在查询不到数据库的中文结果。`</h4>

<h4>3.调用Statement：  <code>Statement statement = connection.createStatement()</code>。</h4>

<h4>4.取结果集：  <code>ResultSet getresault=statement.executeQuery("查询语句")</code>。</h4>

<h4>5.对结果集进行处理：使用 <code>while (getResault.next()) {passtemp = getresault.getString(1);}//数字对应着结果的列编号</code></h4>

<h4>6.连接关闭：  <code>connection.close();</code></h4>

<h4>7.若进行多条语句操作则必须添加事务处理。要在命令开始前设置成commit为false，对执行多条语句后进行commit,若异常后进行rollback，在finally里进行连接终端操作。</h4>
]]></content:encoded>
    </item>
    
    <item>
      <title>第一次</title>
      <link href="http://mtcle.github.io/blog//2014/01/frist/"/>
      <pubDate>2014-01-13T00:00:00+08:00</pubDate>
      <author>mtcle</author>
      <guid>http://mtcle.github.io/blog//2014/01/frist</guid>
      <content:encoded><![CDATA[<p>一切看似简单的东西总能领悟到许多的东西。</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>测试代码高亮</title>
      <link href="http://mtcle.github.io/blog//2014/01/codehighlighttest/"/>
      <pubDate>2014-01-13T00:00:00+08:00</pubDate>
      <author>mtcle</author>
      <guid>http://mtcle.github.io/blog//2014/01/codehighlighttest</guid>
      <content:encoded><![CDATA[<hr />

<p>```java</p>

<pre><code> 
package model;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;

import javax.swing.JOptionPane;

/**
 * 图书类 包括名字，状态，借出次数 属性 包括记录卡 租金类别
 * */
public class Book {
  public String bookName;// 名字
  private int status = 0;// 图书当前状态，默认为0在馆可借，借出为1
  private int rentCounts = 0;// 图书借阅次数
  private int bookRentLevel = 0;// 图书租金级别,默认为0,高级为1
  private Sequence sequence;// 定义一个图书序列号
  private String Id;
  private ArrayList<Record> record = new ArrayList<Record>(); // 规定泛型类型

  public Book(String name, String head) throws ClassNotFoundException {// 只有名字的构造器
    this.bookName = name;
    this.sequence = new Sequence(head);
    this.Id = sequence.toString();
    this.bookRentLevel = 0;
  }

  public Book(String name, String head, int bookRentLevel) throws ClassNotFoundException, SQLException {// 带图书级别的构造器
    this.bookName = name;
    this.bookRentLevel = bookRentLevel;
    this.sequence = new Sequence(head);
    this.Id = sequence.toString();
    Class.forName("com.mysql.jdbc.Driver");
    java.sql.Connection connection =
        DriverManager.getConnection("jdbc:mysql://localhost/book_mgr?characterEncoding=utf8",
            "root", "121126");
//    System.out.println("连接成功！");
//    connection.setAutoCommit(false);
    Statement statement = connection.createStatement();
    statement.execute("insert book (bookid,name,status,booklevel,checkoutsum)value('" + Id + "','"
        + bookName + "', 0 ,'" + bookRentLevel + "','" + rentCounts + "')");
    connection.close();
//    System.out.println("连接关闭！");
    JOptionPane.showMessageDialog(null, "添加成功！", "提示", 1);
  }

  public int getStatus() {
    return status;
  }

  public void setStatus(int status) {
    this.status = status;
  }

  public int getRentCounts() {
    return rentCounts;
  }

  public void setRentCounts() {
    this.rentCounts++;
  }

  public int getBookLevel() {
    return bookRentLevel;
  }

  public void setBookLevel(int bookLevel) {
    this.bookRentLevel = bookLevel;
  }

  public String getId() {
    return Id;
  }

  public Record newRecord() {
    return new Book.Record();
  }


  public ArrayList<Record> getRecord() {
    return record;
  }

  public void setRecord(ArrayList<Record> record) {
    this.record = record;
  }


  /**
   * 记录卡类 包括借出日期，归还日期，图书名字,扩展到借阅者名字
   * */
  public class Record {
    private long checkOutTime;
    private long checkInTime = 0;
    private double totalPrice;
    private String username;
    private double totalfajin = 0;
    Date date = new Date();
    SimpleDateFormat timeformat = new SimpleDateFormat("yyyy-MM-dd");// 格式化时间输出
    
    public Record() {
      try {
        Connection connection =
            DriverManager.getConnection("jdbc:mysql://localhost/book_mgr?characterEncoding=utf8", "root", "121126");
//        System.out.println("连接成功！");
        Statement statement = connection.createStatement();
        statement.execute("insert record (booknumber,userid,checkout,checkin,plan,rent,fajin)value('"+Id+"','"+username+"','"+timeformat.format(checkOutTime)+"','"+timeformat.format(checkInTime)+"','"+timeformat.format(checkInTime+30*24*60*60*1000)+"','"+totalPrice+"','"+totalfajin+"')");      
        connection.close();
//        System.out.println("连接关闭！");
      } catch (SQLException e1) {
//        System.out.println("sql wrong!");
//        e1.printStackTrace();
      }
      this.checkOutTime = date.getTime();
      this.checkInTime = 0;
      this.totalPrice = 0;
      // this.username=username;
    }

    public String getUsername() {
      return username;
    }

    public void setCheckOutTime(long checkOutTime) {
      this.checkOutTime = checkOutTime;
    }

    public String getCheckOutTime() {
      return timeformat.format(checkOutTime);
    }

    // public long getCheckInTime() {
    // return checkInTime;
    // }
    public String getCheckInTime() {
      if (checkInTime == 0)
        return "该图书未归还";
      else
        return timeformat.format(checkInTime);
    }

    public String getTotalPrice() {
      return "" + totalPrice;
    }

    public void setCheckInTime(long checkInTime) {
      this.checkInTime = checkInTime;
    }


    @Override
    public String toString() {

      return "借出日期" + timeformat.format(checkOutTime) + " 归还日期：" + timeformat.format(checkInTime)
          + " 本次费用：" + totalPrice;
    }

    public double rentFee(long checkInTime, double rentPrice) {// 根据日期计算费用
      totalPrice = ((checkInTime - checkOutTime) / (24 * 60 * 60 * 1000) + 1) * rentPrice;// 測試方便
                                                                                          // 先加一
      // System.out.println("总共借阅天数： "+((checkInTime-checkOutTime)/(24*60*60*1000)+1));
      return totalPrice;
    }

    public double fajin(long checkInTime, double fajinfee) {
      
      if (((checkInTime - checkOutTime) / (24 * 60 * 60 * 1000)) > 30) {
        totalfajin = ((checkInTime - checkOutTime) / (24 * 60 * 60 * 1000) - 30) * 2;// 默认罚金为2元一天，后期可以设置
        return totalfajin;
      }
      return totalfajin;
    }
   
  }
}
</code></pre>


<p>```</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>hello～</title>
      <link href="http://mtcle.github.io/blog//2014/01/hello/"/>
      <pubDate>2014-01-10T00:00:00+08:00</pubDate>
      <author>mtcle</author>
      <guid>http://mtcle.github.io/blog//2014/01/hello</guid>
      <content:encoded><![CDATA[<p>hello world~!~ 终于弄好了啊</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
